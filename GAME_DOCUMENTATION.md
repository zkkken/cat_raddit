# 猫咪舒适度游戏 - 完整文档

## 游戏概述
这是一个温度控制游戏，玩家需要通过调节温度来保持猫咪的舒适度。游戏包含多个回合，每回合时间递减，并有各种干扰事件增加挑战性。

## 核心游戏机制

### 1. 温度系统
- **当前温度**: 0-1 范围内的数值，通过 +/- 按钮控制
- **目标温度**: 随机生成的目标值，玩家需要将当前温度调节到接近目标温度
- **容忍范围**: 目标温度周围的可接受范围（默认 ±0.1）
- **自然冷却**: 当没有按钮被按下时，温度会自然下降

### 2. 舒适度系统
- **舒适度**: 0-1 范围内的数值，反映猫咪的快乐程度
- **增长条件**: 当温度在目标范围内时，舒适度上升
- **下降条件**: 当温度偏离目标范围时，舒适度下降
- **视觉反馈**: 不同舒适度对应不同的猫咪头像

### 3. 计时系统
- **游戏时间**: 每回合有限定时间（第1回合30秒，之后每回合减少10秒，最少10秒）
- **成功条件**: 时间结束时舒适度达到80%以上
- **失败条件**: 时间结束时舒适度低于80%

### 4. 干扰系统
- **控制反转**: +/- 按钮功能互换
- **温度冲击**: 目标温度突然变为极值（0.1或0.9）
- **气泡干扰**: 视觉遮挡，影响玩家观察温度条
- **清除方式**: 点击中心按钮可清除当前干扰

### 5. 回合系统
- **多回合**: 游戏包含多个回合，每回合成功后可进入下一回合
- **难度递增**: 每回合时间减少，增加挑战性
- **重新开始**: 失败后可重新开始游戏

## 技术架构

### 核心类结构
1. **GameStateManager**: 主要的游戏状态管理器
2. **TemperatureSystem**: 温度控制和计算
3. **ComfortSystem**: 舒适度管理
4. **InterferenceSystem**: 干扰事件处理
5. **TimerSystem**: 时间管理

### 游戏状态 (GameState)
```typescript
interface GameState {
  currentTemperature: number;      // 当前温度 (0-1)
  targetTemperature: number;       // 目标温度 (0-1)
  toleranceWidth: number;          // 容忍宽度
  currentComfort: number;          // 当前舒适度 (0-1)
  gameTimer: number;               // 游戏剩余时间
  successHoldTimer: number;        // 成功保持时间
  isPlusHeld: boolean;             // + 按钮是否被按下
  isMinusHeld: boolean;            // - 按钮是否被按下
  gameStatus: GameStatus;          // 游戏状态
  interferenceEvent: InterferenceEvent; // 当前干扰事件
  interferenceTimer: number;       // 干扰计时器
  isControlsReversed: boolean;     // 控制是否反转
}
```

### 游戏配置 (GameConfig)
```typescript
interface GameConfig {
  TEMPERATURE_CHANGE_RATE: 0.5;    // 温度变化速率
  TEMPERATURE_COOLING_RATE: 0.3;   // 自然冷却速率
  COMFORT_CHANGE_RATE: 0.2;        // 舒适度变化速率
  GAME_DURATION: 30;               // 游戏时长
  SUCCESS_HOLD_TIME: 5;            // 成功保持时间
  INITIAL_TEMPERATURE: 0.5;        // 初始温度
  TARGET_TEMPERATURE_MIN: 0.3;     // 目标温度最小值
  TARGET_TEMPERATURE_MAX: 0.7;     // 目标温度最大值
  TOLERANCE_WIDTH: 0.1;            // 容忍宽度
  INTERFERENCE_MIN_INTERVAL: 3;    // 干扰最小间隔
  INTERFERENCE_MAX_INTERVAL: 5;    // 干扰最大间隔
  INTERFERENCE_DURATION: 8;        // 干扰持续时间
}
```

## UI 组件说明

### 主要UI元素
1. **温度进度条**: 显示当前温度，包含目标温度线和容忍范围
2. **舒适度进度条**: 显示猫咪当前舒适度
3. **计时器**: 显示剩余时间和当前回合
4. **控制按钮**: +/- 温度控制按钮
5. **中心按钮**: 用于清除干扰事件
6. **猫咪头像**: 根据舒适度显示不同表情

### 视觉反馈
- **温度指针**: 实时显示当前温度位置
- **容忍范围**: 橙色区域显示可接受的温度范围
- **干扰提示**: 不同干扰事件有对应的视觉提示
- **按钮状态**: 控制反转时按钮会有特殊视觉效果

## 移植到 Reddit Devvit 的注意事项

### 需要适配的部分
1. **图片资源**: 需要将图片资源上传到 Devvit 平台或使用 base64 编码
2. **样式系统**: 可能需要调整 CSS 样式以适配 Devvit 的样式系统
3. **事件处理**: 触摸和鼠标事件可能需要适配移动端
4. **定时器**: 确保游戏循环在 Devvit 环境中正常工作

### 保持不变的部分
1. **游戏逻辑**: 所有核心游戏机制可以直接移植
2. **状态管理**: GameStateManager 和相关系统类可以直接使用
3. **数据结构**: 所有接口和类型定义可以保持不变

## 使用说明

### 基本操作
1. 观察目标温度数值和温度条上的红线
2. 使用 +/- 按钮调节当前温度到目标范围内
3. 保持温度在容忍范围内以提升猫咪舒适度
4. 当出现干扰事件时，点击中心按钮清除
5. 在时间结束前将舒适度提升到80%以上

### 获胜条件
- 时间结束时舒适度达到80%或以上
- 可以进入下一回合继续挑战

### 失败条件
- 时间结束时舒适度低于80%
- 需要重新开始游戏

这个合并的代码文件包含了完整的游戏逻辑和UI组件，可以直接用于移植到其他平台。